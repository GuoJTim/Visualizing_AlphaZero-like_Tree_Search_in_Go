<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Dashboard Layout</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    <link rel="stylesheet" href="styles.css">
    <script src="index.js?4545" defer></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="orangeBox.js" defer></script>
    <script src="blueBox.js" defer></script>
    <script src="purpleBox.js" defer></script>
    <script src="greenBox.js" defer></script>
    <script src="goBoard.js?waa" defer></script>
    <script src="readTree.js" defer></script>
    <script src="bluegoBoard.js?1a15123" defer></script>
    <script src="DrawHeatmap.js" defer></script>
    <script src="bluestatus.js?121531" defer></script>
    <script src="drawheatmapbar.js" defer></script>
    <script src="globalTimer.js" defer></script>
    <script src="tree_diagram.js?21" defer></script>
    <style>
        * {
            box-sizing: border-box;
        }

        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
        }

        .container {
            display: grid;
            grid-template-columns: 3fr 2fr 1fr;
            grid-template-rows: 4fr 1fr;
            gap: 10px;
            height: 100vh;
            padding: 20px;
        }

        .orange-box {
            grid-column: 1;
            grid-row: 1;
            border: 3px solid orange;
            height: 100%;
            width: 100%;
        }

        .blue-box {
            grid-column: 2;
            grid-row: 1;
            border: 3px solid blue;
            height: 100%;
        }

        .purple-box {
            grid-column: 3;
            grid-row: 1;
            border: 3px solid purple;
            height: 100%;
        }

        .green-box {
            grid-column: 1 / span 3;
            grid-row: 2;
            border: 3px solid green;
            height: 100%;
            overflow-x: scroll;
            white-space: nowrap;
            display: flex;
            align-items: center;
        }

        .slider-item {
            display: inline-block;
            width: 100px;
            height: 100%;
            margin: 0 20px;
            border: 2px solid black;
            vertical-align: middle;
        }

        .arrow {
            display: inline-block;
            font-size: 2rem;
            cursor: pointer;
            margin: 0 10px;
        }

        .link {
            stroke: black;
            stroke-width: 0.05px;
            fill: none;
        }


        @media (max-width: 768px) {
            .container {
                grid-template-columns: 1fr;
                grid-template-rows: auto auto auto auto;
            }

            .orange-box, .blue-box, .purple-box, .green-box {
                grid-column: 1;
                grid-row: auto;
            }
        }
        
        
        #winrateChart {
            width: 500px;
            height: 200px;
            border: 1px solid #ccc;
            margin: 20px auto;
            position: relative;
            background-color: #000; /* 黑色背景 */
        }
        
        .button-container {
            display: flex;
            justify-content: space-around;
            padding-top: 10px;
        }
        
        button {
            padding: 5px 10px;
            font-size: 16px;
            border: none;
            background-color: white;
            color: purple;
            border-radius: 5px;
            cursor: pointer;
        }
        
        button:hover {
            background-color: lightgray;
        }
        
    </style>
</head>
<body>
    <div class="container">
        <div class="orange-box" id="orangeBox">
            <!-- Orange Box Content -->
            <div id="tree_diagram"></div>
        </div>
        <div class="blue-box" id="blueBox">
            <!-- Blue Box Content -->
        </div>
        <div class="purple-box" id="purpleBox">
            <!-- Purple Box Content -->
            <!-- 上半部：折線圖 -->
            <div id="winrateChart"></div>

            <!-- 下半部：按鈕 -->
            <div id="controlButtons" class="button-container">
                <button id="prevMove">&lt;&lt;</button>
                <button id="prevStep">&lt;</button>
                <button id="pause">||</button>
                <button id="resume">|&gt;</button>
                <button id="nextStep">&gt;</button>
                <button id="nextMove">&gt;&gt;</button>
            </div>
        </div>
        <div class="green-box" id="greenBox">
            <!-- Green Box Content -->
            <script>
                var tmp;
                </script>
            <div id="sliderContent"></div>
            <script type="module">
                document.addEventListener('DOMContentLoaded', async function () {
                    const boardSize = 9;
                    const sliderContent = d3.select('#sliderContent');
                    
                    function generateBoardsFromActions(actions) {
                        const boardSize = 9;
                        let board = Array.from({ length: boardSize }, () => Array(boardSize).fill(0)); // Initialize an empty board
                        const boards = []; // List to store board states after each action
                    
                        actions.forEach((action, index) => {
                            applyAction(board, action); // Apply the action to the current board
                            boards.push(JSON.parse(JSON.stringify(board))); // Save a deep copy of the board state
                        });
                    
                        return boards;
                    }
                    
                    function drawBoardsWithClickEvent(boards, actions) {
                        const sliderContent = d3.select("#sliderContent");
                        sliderContent.selectAll("*").remove(); // Clear previous content
                    
                        boards.forEach((boardData, index) => {
                            const sliderItem = sliderContent
                                .append("div")
                                .attr("class", "slider-item")
                                .on("click", () => {
                                    
                                    setMoveAndStep(index,200);
                                    console.log(`Board clicked: Move ${index}, Action: ${actions[index]}`);
                                    // Add custom click logic here
                                });
                    
                            drawGoBoard(sliderItem, boardData); // Draw the Go board for the current move
                    
                            // Add arrows between boards
                            if (index < boards.length - 1) {
                                sliderContent
                                    .append("div")
                                    .attr("class", "slider-arrow")
                                    .style("display", "inline-block")
                                    .style("vertical-align", "middle")
                                    .html("&#8594;"); // Right arrow symbol
                            }
                        });
                    }
                    
                    // Provided actions list
                    const actions = [
                        "B[E5]","W[E7]","B[G6]","W[G7]","B[C6]","W[F6]","B[F5]","W[G5]","B[H6]",
                        "W[G4]","B[H7]","W[G8]","B[C7]","W[H8]","B[F3]","W[G3]","B[G2]","W[F4]",
                        "B[E4]","W[F2]","B[E3]","W[H2]","B[E6]","W[F7]","B[E2]","W[G1]","B[D8]",
                        "W[E8]","B[E1]","W[D7]","B[C8]","W[D6]","B[D5]","W[E9]","B[F1]","W[G2]",
                        "B[J8]","W[H5]","B[D9]","W[J6]","B[B2]","W[J7]","B[B4]","W[C5]","B[C4]",
                        "W[G6]","B[F9]","W[G9]","B[B6]","W[D3]","B[A8]","W[F8]","B[J1]","W[H3]",
                        "B[B8]","W[J5]","B[J9]","W[H9]","B[B3]","W[B7]","B[C3]","W[H1]","B[C2]",
                        "W[J3]","B[A3]","W[J2]","B[A6]","W[H4]","B[A2]","W[B1]","B[A7]","W[F9]",
                        "B[C9]","W[J9]","B[D4]","W[B5]","B[H6]","W[B9]","B[A9]","W[PASS]","B[A5]",
                        "W[C5]","B[B9]","W[PASS]","B[C1]","W[PASS]","B[D2]","W[PASS]","B[A1]","W[H7]",
                        "B[B5]","W[PASS]","B[D1]","W[J4]","B[B1]","W[PASS]","B[PASS]"
                    ];
                    
                    // Generate boards based on actions
                    const boards = generateBoardsFromActions(actions);
                    
                    // Draw all boards and set up click events
                    drawBoardsWithClickEvent(boards, actions);
                    

                });
                </script>
                
        </div>
    </div>
</body>
</html>
